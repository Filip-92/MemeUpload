<div class="row">
    <div class="col-1"></div>
    <div id="reply" class="col-lg-8 mb-2">
        <div class="row" style="padding-top: 10px; padding-bottom: 10px;">
            <div class="col-2 col-lg-2">
                <div><img id="avatar" src="{{url || '././assets/LogoImage.png'}}" alt=""></div>
                <div><a routerLink='/uzytkownicy/{{reply.username}}' id="username" [ngStyle]="reply?.username?.length > 10 ? { 'font-size': '10px' } : { 'font-size': '14px' }">{{reply.username}}</a></div>
            </div>
            <div id="timeago" class="col-2 col-lg-2" style="margin-left: 10px !important;">
                {{reply.uploaded | timeago}}
            </div>
            <div class="col col-lg-5"></div>
            <div class="col-4 col-lg-2">
                <div class="text-right">
                    <button id="like" class="mr-2" (click)="addLike(reply)"><i class="fa fa-plus" [ngStyle]="!liked ? { 'color': 'white' } : { 'color': 'green' }"></i></button>
                    {{reply.numberOfLikes}}
                    <button id="like" class="ml-2" (click)="addDislike(reply)"><i class="fa fa-minus" [ngStyle]="!disliked ? { 'color': 'white' } : { 'color': 'red' }"></i></button>
                </div>
                <div *ngIf="(accountService.currentUser$ | async) !== null" class="text-left mt-2">
                    <div *ngIf="reply.username === user.username || user.roles[0] === 'Admin' || user.roles[1] === 'Moderator' && reply.content !== '[Komentarz został usunięty]'">
                        <div *ngIf="reply.username === user.username && reply.content !== '[Komentarz został usunięty]'" (click)="editReplyToggle(reply.id) && reloadComments(comment)" style="display: inline-block"><i id="edit" class="fa fa-pencil-square-o" aria-hidden="true"><span class="ml-1"> Edytuj</span></i></div>
                        <div *ngIf="reply.content !== '[Komentarz został usunięty]'" (click)="removeReply(reply.id)"><i id="delete" class="fa fa-trash" aria-hidden="true"><span class="ml-1"> Usuń</span></i></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="text-left" id="content" style="padding: 10px; margin-left: 50px !important;">                    
            <span class="mb-3" *ngIf="reply.content !== '[Komentarz został usunięty]'" style="color: black;">
            @{{reply.replyingToUser}}
            </span>
            <div *ngIf="reply.quote !== null && reply.content !== '[Komentarz został usunięty]'" id="quote" class="text-center mb-3">
                "{{reply.quote}}"
            </div>
            <div>
                {{reply.content}}
            </div>
        </div>
        <div id="image" class="text-center mb-3" *ngIf="reply.url !== null">
            <img src="{{reply.url}}" alt="">
        </div>
        <i class="fa fa-reply ml-3 mb-1" (click)="addReply(reply.commentId)"> Odpowiedz</i>
        <i class="fa fa-quote-left ml-3 mb-1" *ngIf="!ifReply" (click)="addQuotedReply(reply.commentId)"> Zacytuj</i>
    </div>
</div>

<div *ngIf="commentUpdate">
    <div class="text-center mt-2 mb-3" id="editForm">
        <form #editForm="ngForm" (ngSubmit)="editReply()" class="text-center column">
            <textarea type="text" name="content" [(ngModel)]="reply.content" placeholder="{{reply.content}}" class="col-7"></textarea>
            <button class="btn btn-success ml-2 col-2" type="submit" [disabled]="!editForm?.dirty">Edytuj komentarz</button>
        </form>
    </div>
</div>

<div *ngIf="replyField">
    <form [formGroup]='replyForm' (ngSubmit)="replyForm.valid && replyComment()" class="text-center column mb-2">
        <div>
            <div class="col-3"></div>
            <textarea type="text" [formControl]='replyForm.controls["content"]' placeholder="Wpisz treść komentarza" class="col-7 mr-1"></textarea>
            <label class="custom-file-upload" *ngIf="mainMemes > 5">
                <input type="file" ng2FileSelect [uploader]="uploader" (change)="fileChangeEvent($event)" class="text-center" title="Wybierz"/>
                <i class="fa fa-paperclip"></i>
            </label>
            <button class="btn btn-success ml-2 col-2" type="submit" [disabled]="!replyForm.valid">Dodaj komentarz</button>
        </div>
        <div *ngIf="replyForm.controls['content'].errors?.maxlength" class="text-danger">
            Komentarz zbyt długi
        </div>
    </form>
</div>

<div *ngIf="replyQuote">
    <form [formGroup]='replyForm' (ngSubmit)="replyForm.valid && replyComment()" class="text-center column mb-2">
        <div>
            <textarea type="text" [formControl]='replyForm.controls["content"]' placeholder="Wpisz treść komentarza" class="col-7 mr-1"></textarea>
            <button class="btn btn-success ml-2 col-2" type="submit" [disabled]="!replyForm.valid">Dodaj komentarz</button>
        </div>
        <div *ngIf="replyForm.controls['content'].errors?.maxlength" class="text-danger">
            Komentarz zbyt długi
        </div>
    </form>
</div>
